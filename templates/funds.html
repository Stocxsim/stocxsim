{% extends "base.html" %}
{% block title %}Funds | Stocxsim{% endblock %}

{% block css %}
<link rel="stylesheet" href="/static/css/funds.css">
<style>
    .fund-tabs {
        font-weight: 600;
        cursor: pointer;
    }

    .fund-tab {
        color: #6b7280;
        padding-bottom: 6px;
    }

    .fund-tab.active {
        color: #04b488;
        border-bottom: 3px solid #04b488;
    }
</style>
{% endblock %}

{% block content %}
<div class="container" style="font-family: verdana; margin-top: 50px; margin-bottom: 50px;">
    <div class="row g-4">

        <!-- LEFT -->
        <div class="col-md-7">
            <div class="card p-4 text-center">
                <h6 class="text-muted">Stocks balance</h6>
                <h2 style=" color: #374151;">₹{{ user.balance }}</h2>
                <hr>

                <div class="d-flex justify-content-between">
                    <span>Cash</span>
                    <strong style=" color: #374151;">₹{{ user.balance }}</strong>
                </div>
            </div>

            <div class="card mt-3 p-3 d-flex justify-content-between flex-row align-items-center">
                <span>All transactions</span>
                <i class="bi bi-chevron-right"></i>
            </div>
        </div>

        <!-- RIGHT -->
        <div class="col-md-5">
            <div class="card p-4">
                <div class="d-flex justify-content-between funds-tabs">
                    <span id="addTab" class="fund-tab active" onclick="switchTab('add')" style="cursor: pointer;">
                        Add money
                    </span>
                    <span id="withdrawTab" class="fund-tab" onclick="switchTab('withdraw')" style="cursor: pointer;">
                        Withdraw
                    </span>

                </div>
                <hr>
                <input 
  id="amountInput"
  type="number"
  class="form-control text-center fs-1 fw-bold border-0"
  value="0"
  min="0"
  style="color:#374151; box-shadow:none;"
>
<div class="d-flex justify-content-center gap-3 my-4">
  <button class="btn btn-light rounded-pill" onclick="addAmount(1000)">
    +₹1,000
  </button>
  <button class="btn btn-light rounded-pill" onclick="addAmount(5000)">
    +₹5,000
  </button>
  <button class="btn btn-light rounded-pill" onclick="addAmount(10000)">
    +₹10,000
  </button>
</div>



                <div id="infoBox" class="alert alert-light text-center" style="padding:10px;">
                    Enter amount to add
                </div>
                <button id="actionBtn" class="btn w-100 mt-4" style="background-color:#04b488; color:white;">
                    Add money
                </button>
            </div>
        </div>

    </div>
</div>
{% endblock %}
{% block js %}
<script>
    var currentTab = "add";
  function switchTab(type) {
    const addTab = document.getElementById("addTab");
    const withdrawTab = document.getElementById("withdrawTab");
    const actionBtn = document.getElementById("actionBtn");
    const infoBox = document.getElementById("infoBox");
    const amountInput = document.getElementById("amountInput");

    if (type === "add") {
      addTab.classList.add("active");
      withdrawTab.classList.remove("active");

      actionBtn.innerText = "Add money";
      actionBtn.style.backgroundColor = "#04b488";
      infoBox.innerText = "Enter amount to add";
      currentTab = "add";
    } 
    else {
      withdrawTab.classList.add("active");
      addTab.classList.remove("active");

      actionBtn.innerText = "Withdraw";
      actionBtn.style.backgroundColor = "#04b488";

      infoBox.innerText = "No balance available to withdraw";
      amountInput.value = 0;
    currentTab = "withdraw";
    }
  }

  function addAmount(value) {
    const amountInput = document.getElementById("amountInput");
    let current = parseInt(amountInput.value || 0);
    amountInput.value = current + value;
  }

    document.getElementById("actionBtn").addEventListener("click", function() {
        const amountInput = document.getElementById("amountInput");
        let amount = parseInt(amountInput.value || 0);
    
        if (amount <= 0) {
        alert("Please enter a valid amount greater than 0.");
        return;
        }
    
        if (currentTab === "add") {
        // Redirect to add funds route
        window.location.href = `/login/add_funds?amount=${amount}`;
        } else {
        // Redirect to withdraw funds route
        window.location.href = `/login/withdraw_funds?amount=${amount}`;
        }
    });
</script>
{% endblock %}
