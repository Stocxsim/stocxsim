{% extends "base.html" %}

{% block title %}Dashboard - Stocxsim{% endblock %}

{% block css %}
<link rel="stylesheet" href="/static/css/dashboard.css">
{% endblock %}

{% block content %}

<section>
  <div class="container my-4">
    <div class="row">
      <!-- LEFT MAIN CONTENT -->
      <main class="col-lg-8 col-12 order-2 order-lg-1 mb-3">

        <!-- Watchlist Section -->
        <div class="dashboard-section">
          <div class="section-header">
            <h5 class="section-title"><i class="bi bi-star"></i> My Watchlist</h5>
          </div>
          <div class="dashboard-watchlist-scroll">
            <div id="stocksRow" class="watchlist-row-wrap">
              <!-- for js -->
            </div>
          </div>
        </div>

        <!-- CHART SECTION -->
        <div class="dashboard-section chart-section">
          <div class="section-header">
            <h5 class="section-title"><i class="bi bi-graph-up"></i> Performance Overview</h5>
            <span class="chart-active-label" id="chartTitle">Weekly Orders</span>
          </div>
          <div class="chart-card">
            <div id="chartContainer"></div>
          </div>
        </div>

      </main>

      <!-- RIGHT SIDEBAR -->
      <aside class="col-lg-4 col-12 order-1 order-lg-2">

        <!-- Your Investments -->
        <div class="sidebar-card investments-card" id="investmentsCard" onclick="window.location.href='/login/holding'"
          style="cursor: pointer;">
          <div class="sidebar-accent-bar"></div>
          <div class="sidebar-card-header">
            <div class="sidebar-header-icon"><i class="bi bi-wallet2"></i></div>
            <h6 class="sidebar-card-title">Your Investments</h6>
          </div>
          <div class="sidebar-card-body">
            <div class="investment-current">
              <span class="investment-label">Current Value</span>
              <span id="dashboard-current" class="investment-value">--</span>
            </div>
            <div class="investment-row">
              <span class="investment-label">1D Returns</span>
              <span id="dashboard-1d" class="investment-metric">--</span>
            </div>
            <div class="investment-row">
              <span class="investment-label">Total Returns</span>
              <span id="dashboard-total" class="investment-metric">--</span>
            </div>
            <div class="investment-row">
              <span class="investment-label">Invested</span>
              <span id="dashboard-invested" class="investment-metric">--</span>
            </div>
          </div>
        </div>

        <!-- Analytics buttons -->
        <div class="sidebar-card analytics-card">
          <div class="sidebar-card-header">
            <div class="sidebar-header-icon"><i class="bi bi-bar-chart-line"></i></div>
            <h6 class="sidebar-card-title">Analytics</h6>
          </div>
          <div class="sidebar-card-body analytics-body">
            <button class="analytics-btn active" type="button" data-chart="weekly" onclick="loadChart('weekly')">
              <i class="bi bi-bar-chart-fill analytics-icon"></i>
              <span>Weekly Orders</span>
            </button>
            <button class="analytics-btn" type="button" data-chart="win" onclick="loadChart('win')">
              <i class="bi bi-pie-chart-fill analytics-icon"></i>
              <span>Win Rate</span>
            </button>
            <button class="analytics-btn" type="button" data-chart="pl" onclick="loadChart('pl')">
              <i class="bi bi-graph-up-arrow analytics-icon"></i>
              <span>Profit / Loss</span>
            </button>
            <button class="analytics-btn" type="button" data-chart="top" onclick="loadChart('top')">
              <i class="bi bi-trophy-fill analytics-icon"></i>
              <span>Top Traded</span>
            </button>
          </div>
        </div>
      </aside>
    </div>
  </div>
</section>

{% endblock %}

{% block js %}
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<script src="/static/js/holding.js"></script>
<!-- For Plotly -->
<script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>
<script src="/static/js/dashboard.js"></script>
{% endblock %}